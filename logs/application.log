[2026-01-11 14:09:25.565] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 7704 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 14:09:25.569] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 14:09:25.570] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 14:09:27.492] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 14:09:27.579] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 14:09:29.036] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 14:09:29.533] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 14:09:29.540] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 14:09:29.717] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 14:09:31.659] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 14:09:32.024] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 14:09:32.064] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 14:09:32.070] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 14:09:32.123] ERROR [main] o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'execute' defined in class path resource [dev/prj/sbatch1/infra/batch/job/CsvProcessorAndPersistJob.class]: Unsatisfied dependency expressed through method 'execute' parameter 1: Error creating bean with name 'processAndValidateStep' defined in class path resource [dev/prj/sbatch1/infra/batch/step/FileProcessingSteps.class]: Failed to instantiate [org.springframework.batch.core.step.Step]: Factory method 'processAndValidateStep' threw exception with message: Item writer must not be null
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:804)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:546)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1362)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1194)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:565)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:525)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:371)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:331)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:196)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.instantiateSingleton(DefaultListableBeanFactory.java:1218)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingleton(DefaultListableBeanFactory.java:1184)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:1121)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:993)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:620)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:756)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:445)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:321)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'processAndValidateStep' defined in class path resource [dev/prj/sbatch1/infra/batch/step/FileProcessingSteps.class]: Failed to instantiate [org.springframework.batch.core.step.Step]: Factory method 'processAndValidateStep' threw exception with message: Item writer must not be null
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:657)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:645)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1362)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1194)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:565)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:525)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:371)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:331)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:201)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveBean(DefaultListableBeanFactory.java:1225)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1704)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1651)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:912)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791)
	... 20 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.batch.core.step.Step]: Factory method 'processAndValidateStep' threw exception with message: Item writer must not be null
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.lambda$instantiate$0(SimpleInstantiationStrategy.java:183)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiateWithFactoryMethod(SimpleInstantiationStrategy.java:72)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:152)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:653)
	... 34 common frames omitted
Caused by: java.lang.IllegalArgumentException: Item writer must not be null
	at org.springframework.util.Assert.notNull(Assert.java:182)
	at org.springframework.batch.core.step.builder.ChunkOrientedStepBuilder.build(ChunkOrientedStepBuilder.java:401)
	at dev.prj.sbatch1.infra.batch.step.FileProcessingSteps.processAndValidateStep(FileProcessingSteps.java:33)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.lambda$instantiate$0(SimpleInstantiationStrategy.java:155)
	... 37 common frames omitted
[2026-01-11 14:11:06.981] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 15996 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 14:11:06.985] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 14:11:06.987] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 14:11:08.817] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 14:11:08.902] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 14:11:09.939] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 14:11:10.355] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 14:11:10.358] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 14:11:10.470] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 14:11:12.635] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 14:11:12.978] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 14:11:13.011] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 14:11:13.018] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 14:11:13.069] ERROR [main] o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'execute' defined in class path resource [dev/prj/sbatch1/infra/batch/job/CsvProcessorAndPersistJob.class]: Unsatisfied dependency expressed through method 'execute' parameter 1: Error creating bean with name 'processAndValidateStep' defined in class path resource [dev/prj/sbatch1/infra/batch/step/FileProcessingSteps.class]: Failed to instantiate [org.springframework.batch.core.step.Step]: Factory method 'processAndValidateStep' threw exception with message: Item writer must not be null
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:804)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:546)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1362)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1194)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:565)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:525)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:371)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:331)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:196)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.instantiateSingleton(DefaultListableBeanFactory.java:1218)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingleton(DefaultListableBeanFactory.java:1184)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:1121)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:993)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:620)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:756)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:445)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:321)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'processAndValidateStep' defined in class path resource [dev/prj/sbatch1/infra/batch/step/FileProcessingSteps.class]: Failed to instantiate [org.springframework.batch.core.step.Step]: Factory method 'processAndValidateStep' threw exception with message: Item writer must not be null
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:657)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:645)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1362)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1194)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:565)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:525)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:371)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:331)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:201)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveBean(DefaultListableBeanFactory.java:1225)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1704)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1651)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:912)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791)
	... 20 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.batch.core.step.Step]: Factory method 'processAndValidateStep' threw exception with message: Item writer must not be null
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.lambda$instantiate$0(SimpleInstantiationStrategy.java:183)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiateWithFactoryMethod(SimpleInstantiationStrategy.java:72)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:152)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:653)
	... 34 common frames omitted
Caused by: java.lang.IllegalArgumentException: Item writer must not be null
	at org.springframework.util.Assert.notNull(Assert.java:182)
	at org.springframework.batch.core.step.builder.ChunkOrientedStepBuilder.build(ChunkOrientedStepBuilder.java:401)
	at dev.prj.sbatch1.infra.batch.step.FileProcessingSteps.processAndValidateStep(FileProcessingSteps.java:35)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.lambda$instantiate$0(SimpleInstantiationStrategy.java:155)
	... 37 common frames omitted
[2026-01-11 14:11:48.951] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 13864 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 14:11:48.955] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 14:11:48.956] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 14:11:50.656] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 14:11:50.730] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 14:11:52.382] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 14:11:52.706] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 14:11:52.710] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 14:11:52.821] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 14:11:54.521] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 14:11:54.832] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 14:11:55.635] INFO  [main] dev.prj.sbatch1.Sbatch1 - Started Sbatch1 in 7.519 seconds (process running for 9.265)
[2026-01-11 14:12:53.319] WARN  [HikariPool-1:housekeeper] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m500ms263µs700ns).
[2026-01-11 14:13:17.972] DEBUG [main] d.p.s.infra.batch.writer.FileWriter - Writing file...
[2026-01-11 14:13:18.000] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 14:13:18.004] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 14:15:44.210] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 3424 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 14:15:44.214] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 14:15:44.215] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 14:15:46.059] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 14:15:46.155] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 14:15:47.179] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 14:15:47.482] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 14:15:47.485] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 14:15:47.586] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 14:15:49.377] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 14:15:49.721] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 14:15:50.510] INFO  [main] dev.prj.sbatch1.Sbatch1 - Started Sbatch1 in 7.029 seconds (process running for 8.286)
[2026-01-11 14:17:38.853] WARN  [HikariPool-1:housekeeper] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m51s265ms620µs800ns).
[2026-01-11 14:17:38.881] DEBUG [main] d.p.s.infra.batch.writer.FileWriter - Writing file...
[2026-01-11 14:17:38.907] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 14:17:38.910] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 14:17:45.572] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 18204 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 14:17:45.577] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 14:17:45.578] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 14:17:47.330] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 14:17:47.441] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 14:17:48.650] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 14:17:48.990] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 14:17:48.994] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 14:17:49.109] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 14:17:50.746] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 14:17:51.078] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 14:17:51.796] INFO  [main] dev.prj.sbatch1.Sbatch1 - Started Sbatch1 in 6.943 seconds (process running for 8.196)
[2026-01-11 14:18:13.995] DEBUG [main] d.p.s.infra.batch.writer.FileWriter - Writing file...
[2026-01-11 14:18:14.023] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 14:18:14.028] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 14:40:59.712] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 14032 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 14:40:59.717] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 14:40:59.719] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 14:41:01.959] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 14:41:02.056] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 14:41:03.162] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 14:41:03.644] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 14:41:03.649] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 14:41:03.754] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 14:41:05.556] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 14:41:58.004] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 14:41:58.880] INFO  [main] dev.prj.sbatch1.Sbatch1 - Started Sbatch1 in 60.055 seconds (process running for 61.46)
[2026-01-11 14:41:59.137] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Retry exhausted after last attempt in recovery path, but exception is not skippable
[2026-01-11 14:41:59.137] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Rolling back chunk transaction
java.lang.NullPointerException: Cannot invoke "org.springframework.batch.infrastructure.item.ItemWriter.write(org.springframework.batch.infrastructure.item.Chunk)" because "writer" is null
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy108.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
[2026-01-11 14:41:59.146] ERROR [main] o.s.batch.core.step.AbstractStep - Encountered an error executing step processAndValidateStep in job fileProcessorJob
org.springframework.batch.core.step.FatalStepExecutionException: Unable to process chunk
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:458)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy108.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
Caused by: java.lang.NullPointerException: Cannot invoke "org.springframework.batch.infrastructure.item.ItemWriter.write(org.springframework.batch.infrastructure.item.Chunk)" because "writer" is null
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	... 52 common frames omitted
[2026-01-11 14:41:59.170] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 14:41:59.174] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 14:49:43.161] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 18232 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 14:49:43.166] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 14:49:43.168] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 14:49:44.949] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 14:49:45.041] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 14:49:46.356] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 14:49:46.867] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 14:49:46.871] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 14:49:47.052] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 14:49:49.194] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 14:50:23.104] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 14:50:23.949] INFO  [main] dev.prj.sbatch1.Sbatch1 - Started Sbatch1 in 41.542 seconds (process running for 42.976)
[2026-01-11 14:50:24.205] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Retry exhausted after last attempt in recovery path, but exception is not skippable
[2026-01-11 14:50:24.206] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Rolling back chunk transaction
java.lang.NullPointerException: Cannot invoke "org.springframework.batch.infrastructure.item.ItemWriter.write(org.springframework.batch.infrastructure.item.Chunk)" because "writer" is null
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy108.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
[2026-01-11 14:50:24.212] ERROR [main] o.s.batch.core.step.AbstractStep - Encountered an error executing step processAndValidateStep in job fileProcessorJob
org.springframework.batch.core.step.FatalStepExecutionException: Unable to process chunk
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:458)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy108.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
Caused by: java.lang.NullPointerException: Cannot invoke "org.springframework.batch.infrastructure.item.ItemWriter.write(org.springframework.batch.infrastructure.item.Chunk)" because "writer" is null
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	... 52 common frames omitted
[2026-01-11 14:50:24.231] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 14:50:24.234] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 14:59:39.188] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 736 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 14:59:39.192] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 14:59:39.193] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 14:59:40.925] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 14:59:41.019] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 14:59:42.255] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 14:59:42.690] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 14:59:42.694] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 14:59:42.815] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 14:59:44.915] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 14:59:56.031] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 14:59:56.870] INFO  [main] dev.prj.sbatch1.Sbatch1 - Started Sbatch1 in 18.407 seconds (process running for 19.791)
[2026-01-11 14:59:57.319] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Retry exhausted after last attempt in recovery path, but exception is not skippable
[2026-01-11 14:59:57.320] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Rolling back chunk transaction
java.lang.IllegalArgumentException: Class 'class dev.prj.sbatch1.domain.model.ValidCustomer' is not an entity class
	at org.hibernate.internal.SessionImpl.assertInstanceOfEntityType(SessionImpl.java:1740)
	at org.hibernate.internal.SessionImpl.contains(SessionImpl.java:1712)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:362)
	at jdk.proxy2/jdk.proxy2.$Proxy105.contains(Unknown Source)
	at org.springframework.batch.infrastructure.item.database.JpaItemWriter.doWrite(JpaItemWriter.java:128)
	at org.springframework.batch.infrastructure.item.database.JpaItemWriter.write(JpaItemWriter.java:106)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy108.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
Caused by: org.hibernate.UnknownEntityTypeException: Unknown entity type 'dev.prj.sbatch1.domain.model.ValidCustomer'
	at org.hibernate.metamodel.model.domain.internal.MappingMetamodelImpl.getEntityDescriptor(MappingMetamodelImpl.java:326)
	at org.hibernate.internal.AbstractSharedSessionContract.requireEntityPersister(AbstractSharedSessionContract.java:1111)
	at org.hibernate.internal.SessionImpl.assertInstanceOfEntityType(SessionImpl.java:1736)
	... 63 common frames omitted
[2026-01-11 14:59:57.327] ERROR [main] o.s.batch.core.step.AbstractStep - Encountered an error executing step processAndValidateStep in job fileProcessorJob
org.springframework.batch.core.step.FatalStepExecutionException: Unable to process chunk
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:458)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy108.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
Caused by: java.lang.IllegalArgumentException: Class 'class dev.prj.sbatch1.domain.model.ValidCustomer' is not an entity class
	at org.hibernate.internal.SessionImpl.assertInstanceOfEntityType(SessionImpl.java:1740)
	at org.hibernate.internal.SessionImpl.contains(SessionImpl.java:1712)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:362)
	at jdk.proxy2/jdk.proxy2.$Proxy105.contains(Unknown Source)
	at org.springframework.batch.infrastructure.item.database.JpaItemWriter.doWrite(JpaItemWriter.java:128)
	at org.springframework.batch.infrastructure.item.database.JpaItemWriter.write(JpaItemWriter.java:106)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	... 52 common frames omitted
Caused by: org.hibernate.UnknownEntityTypeException: Unknown entity type 'dev.prj.sbatch1.domain.model.ValidCustomer'
	at org.hibernate.metamodel.model.domain.internal.MappingMetamodelImpl.getEntityDescriptor(MappingMetamodelImpl.java:326)
	at org.hibernate.internal.AbstractSharedSessionContract.requireEntityPersister(AbstractSharedSessionContract.java:1111)
	at org.hibernate.internal.SessionImpl.assertInstanceOfEntityType(SessionImpl.java:1736)
	... 63 common frames omitted
[2026-01-11 14:59:57.354] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 14:59:57.360] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 15:09:04.285] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 256 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 15:09:04.289] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 15:09:04.290] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 15:09:05.944] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 15:09:06.029] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 15:09:07.022] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 15:09:07.448] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 15:09:07.451] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 15:09:07.559] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 15:09:08.802] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 15:09:09.022] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 15:09:09.863] INFO  [main] dev.prj.sbatch1.Sbatch1 - Started Sbatch1 in 6.322 seconds (process running for 7.73)
[2026-01-11 15:09:10.284] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Retry exhausted after last attempt in recovery path, but exception is not skippable
[2026-01-11 15:09:10.284] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Rolling back chunk transaction
jakarta.persistence.TransactionRequiredException: No active transaction
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:612)
	at org.hibernate.internal.SessionImpl.checkTransactionNeededForUpdateOperation(SessionImpl.java:155)
	at org.hibernate.internal.SessionImpl.checkTransactionNeededForUpdateOperation(SessionImpl.java:2392)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1484)
	at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1477)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:362)
	at jdk.proxy2/jdk.proxy2.$Proxy103.flush(Unknown Source)
	at org.springframework.batch.infrastructure.item.database.JpaItemWriter.write(JpaItemWriter.java:107)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy106.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
[2026-01-11 15:09:10.293] ERROR [main] o.s.batch.core.step.AbstractStep - Encountered an error executing step processAndValidateStep in job fileProcessorJob
org.springframework.batch.core.step.FatalStepExecutionException: Unable to process chunk
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:458)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy106.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
Caused by: jakarta.persistence.TransactionRequiredException: No active transaction
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:612)
	at org.hibernate.internal.SessionImpl.checkTransactionNeededForUpdateOperation(SessionImpl.java:155)
	at org.hibernate.internal.SessionImpl.checkTransactionNeededForUpdateOperation(SessionImpl.java:2392)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1484)
	at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1477)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:362)
	at jdk.proxy2/jdk.proxy2.$Proxy103.flush(Unknown Source)
	at org.springframework.batch.infrastructure.item.database.JpaItemWriter.write(JpaItemWriter.java:107)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	... 52 common frames omitted
[2026-01-11 15:09:10.315] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 15:09:10.320] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 15:10:04.562] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 11224 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 15:10:04.565] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 15:10:04.566] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 15:10:06.262] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 15:10:06.385] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 15:10:07.405] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 15:10:07.807] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 15:10:07.810] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 15:10:07.901] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 15:10:09.200] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 15:10:09.730] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 15:10:10.383] INFO  [main] dev.prj.sbatch1.Sbatch1 - Started Sbatch1 in 6.531 seconds (process running for 7.512)
[2026-01-11 15:10:10.648] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Retry exhausted after last attempt in recovery path, but exception is not skippable
[2026-01-11 15:10:10.648] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Rolling back chunk transaction
jakarta.persistence.TransactionRequiredException: No active transaction
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:612)
	at org.hibernate.internal.SessionImpl.checkTransactionNeededForUpdateOperation(SessionImpl.java:155)
	at org.hibernate.internal.SessionImpl.checkTransactionNeededForUpdateOperation(SessionImpl.java:2392)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1484)
	at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1477)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:362)
	at jdk.proxy2/jdk.proxy2.$Proxy104.flush(Unknown Source)
	at org.springframework.batch.infrastructure.item.database.JpaItemWriter.write(JpaItemWriter.java:107)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy108.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
[2026-01-11 15:10:10.655] ERROR [main] o.s.batch.core.step.AbstractStep - Encountered an error executing step processAndValidateStep in job fileProcessorJob
org.springframework.batch.core.step.FatalStepExecutionException: Unable to process chunk
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:458)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy108.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
Caused by: jakarta.persistence.TransactionRequiredException: No active transaction
	at org.hibernate.internal.AbstractSharedSessionContract.checkTransactionNeededForUpdateOperation(AbstractSharedSessionContract.java:612)
	at org.hibernate.internal.SessionImpl.checkTransactionNeededForUpdateOperation(SessionImpl.java:155)
	at org.hibernate.internal.SessionImpl.checkTransactionNeededForUpdateOperation(SessionImpl.java:2392)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1484)
	at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1477)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:362)
	at jdk.proxy2/jdk.proxy2.$Proxy104.flush(Unknown Source)
	at org.springframework.batch.infrastructure.item.database.JpaItemWriter.write(JpaItemWriter.java:107)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	... 52 common frames omitted
[2026-01-11 15:10:10.671] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 15:10:10.674] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 15:12:51.492] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 16488 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 15:12:51.496] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 15:12:51.497] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 15:12:53.212] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 15:12:53.284] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 15:12:54.501] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 15:12:54.908] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 15:12:54.911] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 15:12:55.022] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 15:12:56.751] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 15:12:57.268] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 15:12:57.963] INFO  [main] dev.prj.sbatch1.Sbatch1 - Started Sbatch1 in 7.111 seconds (process running for 8.112)
[2026-01-11 15:12:58.360] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 15:12:58.363] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 15:13:21.745] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 15824 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 15:13:21.748] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 15:13:21.748] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 15:13:23.460] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 15:13:23.542] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 15:13:24.408] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 15:13:24.812] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 15:13:24.814] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 15:13:24.907] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 15:13:26.759] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 15:13:27.278] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 15:13:27.847] INFO  [main] dev.prj.sbatch1.Sbatch1 - Started Sbatch1 in 6.728 seconds (process running for 7.788)
[2026-01-11 15:13:28.120] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Retry exhausted after last attempt in recovery path, but exception is not skippable
[2026-01-11 15:13:28.121] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Rolling back chunk transaction
org.springframework.batch.infrastructure.item.WriterNotOpenException: Writer must be open before it can be written to
	at org.springframework.batch.infrastructure.item.support.AbstractFileItemWriter.write(AbstractFileItemWriter.java:227)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy108.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
[2026-01-11 15:13:28.131] ERROR [main] o.s.batch.core.step.AbstractStep - Encountered an error executing step processAndValidateStep in job fileProcessorJob
org.springframework.batch.core.step.FatalStepExecutionException: Unable to process chunk
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:458)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy108.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
Caused by: org.springframework.batch.infrastructure.item.WriterNotOpenException: Writer must be open before it can be written to
	at org.springframework.batch.infrastructure.item.support.AbstractFileItemWriter.write(AbstractFileItemWriter.java:227)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	... 52 common frames omitted
[2026-01-11 15:13:28.155] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 15:13:28.170] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 15:19:44.831] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 13340 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 15:19:44.834] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 15:19:44.835] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 15:19:46.381] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 15:19:46.450] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 15:19:47.726] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 15:19:48.243] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 15:19:48.248] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 15:19:48.400] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 15:19:50.079] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 15:19:50.552] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 15:19:51.211] INFO  [main] dev.prj.sbatch1.Sbatch1 - Started Sbatch1 in 6.989 seconds (process running for 7.994)
[2026-01-11 15:19:51.610] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Retry exhausted after last attempt in recovery path, but exception is not skippable
[2026-01-11 15:19:51.610] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Rolling back chunk transaction
org.springframework.batch.infrastructure.item.WriterNotOpenException: Writer must be open before it can be written to
	at org.springframework.batch.infrastructure.item.support.AbstractFileItemWriter.write(AbstractFileItemWriter.java:227)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.aop.support.DelegatingIntroductionInterceptor.doProceed(DelegatingIntroductionInterceptor.java:134)
	at org.springframework.aop.support.DelegatingIntroductionInterceptor.invoke(DelegatingIntroductionInterceptor.java:122)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:719)
	at org.springframework.batch.infrastructure.item.file.FlatFileItemWriter$$SpringCGLIB$$0.write(<generated>)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy109.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
[2026-01-11 15:19:51.622] ERROR [main] o.s.batch.core.step.AbstractStep - Encountered an error executing step processAndValidateStep in job fileProcessorJob
org.springframework.batch.core.step.FatalStepExecutionException: Unable to process chunk
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:458)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy109.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
Caused by: org.springframework.batch.infrastructure.item.WriterNotOpenException: Writer must be open before it can be written to
	at org.springframework.batch.infrastructure.item.support.AbstractFileItemWriter.write(AbstractFileItemWriter.java:227)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.aop.support.DelegatingIntroductionInterceptor.doProceed(DelegatingIntroductionInterceptor.java:134)
	at org.springframework.aop.support.DelegatingIntroductionInterceptor.invoke(DelegatingIntroductionInterceptor.java:122)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:719)
	at org.springframework.batch.infrastructure.item.file.FlatFileItemWriter$$SpringCGLIB$$0.write(<generated>)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	... 52 common frames omitted
[2026-01-11 15:19:51.639] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 15:19:51.642] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 15:28:30.330] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 13308 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 15:28:30.333] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 15:28:30.334] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 15:28:31.950] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 15:28:32.023] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 15:28:33.227] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 15:28:33.645] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 15:28:33.648] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 15:28:33.771] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 15:28:35.426] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 15:28:35.743] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 15:28:35.748] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 15:28:35.792] ERROR [main] o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 4 of method processAndValidateStep in dev.prj.sbatch1.infra.batch.step.FileProcessingSteps required a single bean, but 3 were found:
	- customerClassifierWriter: defined by method 'customerClassifierWriter' in class path resource [dev/prj/sbatch1/infra/batch/writer/FileWriter.class]
	- validCustomerWriter: defined in BeanDefinition defined in class path resource [dev/prj/sbatch1/infra/batch/writer/FileWriter.class]
	- invalidCustomerWriter: defined in BeanDefinition defined in class path resource [dev/prj/sbatch1/infra/batch/writer/FileWriter.class]

This may be due to missing parameter name information

Action:

Consider marking one of the beans as @Primary, updating the consumer to accept multiple beans, or using @Qualifier to identify the bean that should be consumed

Ensure that your compiler is configured to use the '-parameters' flag.
You may need to update both your build tool settings as well as your IDE.
(See https://github.com/spring-projects/spring-framework/wiki/Spring-Framework-6.1-Release-Notes#parameter-name-retention)


[2026-01-11 15:31:13.819] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 7884 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 15:31:13.822] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 15:31:13.823] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 15:31:15.352] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 15:31:15.437] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 15:31:16.305] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 15:31:16.660] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 15:31:16.663] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 15:31:16.763] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 15:31:18.176] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 15:31:18.500] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 15:31:18.506] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 15:31:18.555] ERROR [main] o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 4 of method processAndValidateStep in dev.prj.sbatch1.infra.batch.step.FileProcessingSteps required a single bean, but 3 were found:
	- customerClassifierWriter: defined by method 'customerClassifierWriter' in class path resource [dev/prj/sbatch1/infra/batch/writer/FileWriter.class]
	- validCustomerWriter: defined in BeanDefinition defined in class path resource [dev/prj/sbatch1/infra/batch/writer/FileWriter.class]
	- invalidCustomerWriter: defined in BeanDefinition defined in class path resource [dev/prj/sbatch1/infra/batch/writer/FileWriter.class]

This may be due to missing parameter name information

Action:

Consider marking one of the beans as @Primary, updating the consumer to accept multiple beans, or using @Qualifier to identify the bean that should be consumed

Ensure that your compiler is configured to use the '-parameters' flag.
You may need to update both your build tool settings as well as your IDE.
(See https://github.com/spring-projects/spring-framework/wiki/Spring-Framework-6.1-Release-Notes#parameter-name-retention)


[2026-01-11 15:33:49.561] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 10768 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 15:33:49.565] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 15:33:49.566] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 15:33:51.449] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 15:33:51.542] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 15:33:52.559] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 15:33:52.855] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 15:33:52.857] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 15:33:52.939] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 15:33:54.483] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 15:33:54.796] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 15:33:54.803] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 15:33:54.853] ERROR [main] o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

The dependencies of some of the beans in the application context form a cycle:

   execute defined in class path resource [dev/prj/sbatch1/infra/batch/job/CsvProcessorAndPersistJob.class]
      ↓
   processAndValidateStep defined in class path resource [dev/prj/sbatch1/infra/batch/step/FileProcessingSteps.class]
┌─────┐
|  customerClassifierWriter defined in class path resource [dev/prj/sbatch1/infra/batch/writer/FileWriter.class]
└─────┘


Action:

Relying upon circular references is discouraged and they are prohibited by default. Update your application to remove the dependency cycle between beans. As a last resort, it may be possible to break the cycle automatically by setting spring.main.allow-circular-references to true.

[2026-01-11 15:36:41.424] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 14612 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 15:36:41.427] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 15:36:41.429] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 15:36:42.980] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 15:36:43.061] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 15:36:44.144] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 15:36:44.528] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 15:36:44.531] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 15:36:44.633] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 15:36:46.273] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 15:36:46.595] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 15:36:47.317] INFO  [main] dev.prj.sbatch1.Sbatch1 - Started Sbatch1 in 6.506 seconds (process running for 7.647)
[2026-01-11 15:36:47.699] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Retry exhausted after last attempt in recovery path, but exception is not skippable
[2026-01-11 15:36:47.699] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Rolling back chunk transaction
org.springframework.batch.infrastructure.item.WriterNotOpenException: Writer must be open before it can be written to
	at org.springframework.batch.infrastructure.item.support.AbstractFileItemWriter.write(AbstractFileItemWriter.java:227)
	at dev.prj.sbatch1.infra.batch.writer.FileWriter.lambda$invalidCustomerWriter$0(FileWriter.java:83)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy107.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
[2026-01-11 15:36:47.709] ERROR [main] o.s.batch.core.step.AbstractStep - Encountered an error executing step processAndValidateStep in job fileProcessorJob
org.springframework.batch.core.step.FatalStepExecutionException: Unable to process chunk
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:458)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy107.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
Caused by: org.springframework.batch.infrastructure.item.WriterNotOpenException: Writer must be open before it can be written to
	at org.springframework.batch.infrastructure.item.support.AbstractFileItemWriter.write(AbstractFileItemWriter.java:227)
	at dev.prj.sbatch1.infra.batch.writer.FileWriter.lambda$invalidCustomerWriter$0(FileWriter.java:83)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	... 52 common frames omitted
[2026-01-11 15:36:47.725] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 15:36:47.727] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 15:37:21.223] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 3564 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 15:37:21.228] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 15:37:21.229] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 15:37:23.353] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 15:37:23.424] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 15:37:25.081] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 15:37:25.608] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 15:37:25.614] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 15:37:25.768] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 15:37:27.829] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 15:37:28.251] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 15:37:28.897] INFO  [main] dev.prj.sbatch1.Sbatch1 - Started Sbatch1 in 8.416 seconds (process running for 9.831)
[2026-01-11 15:37:49.811] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Retry exhausted after last attempt in recovery path, but exception is not skippable
[2026-01-11 15:37:49.811] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Rolling back chunk transaction
org.springframework.batch.infrastructure.item.WriterNotOpenException: Writer must be open before it can be written to
	at org.springframework.batch.infrastructure.item.support.AbstractFileItemWriter.write(AbstractFileItemWriter.java:227)
	at dev.prj.sbatch1.infra.batch.writer.FileWriter.lambda$invalidCustomerWriter$0(FileWriter.java:83)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy107.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
[2026-01-11 15:37:49.829] ERROR [main] o.s.batch.core.step.AbstractStep - Encountered an error executing step processAndValidateStep in job fileProcessorJob
org.springframework.batch.core.step.FatalStepExecutionException: Unable to process chunk
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:458)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy107.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
Caused by: org.springframework.batch.infrastructure.item.WriterNotOpenException: Writer must be open before it can be written to
	at org.springframework.batch.infrastructure.item.support.AbstractFileItemWriter.write(AbstractFileItemWriter.java:227)
	at dev.prj.sbatch1.infra.batch.writer.FileWriter.lambda$invalidCustomerWriter$0(FileWriter.java:83)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	... 52 common frames omitted
[2026-01-11 15:37:49.863] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 15:37:49.869] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 15:44:04.623] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 12940 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 15:44:04.626] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 15:44:04.627] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 15:44:06.377] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 15:44:06.458] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 15:44:07.273] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 15:44:07.555] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 15:44:07.557] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 15:44:07.633] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 15:44:09.309] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 15:44:09.669] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 15:44:09.675] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
[2026-01-11 15:44:09.743] ERROR [main] o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 4 of method processAndValidateStep in dev.prj.sbatch1.infra.batch.step.FileProcessingSteps required a single bean, but 3 were found:
	- validCustomerWriter: defined by method 'validCustomerWriter' in class path resource [dev/prj/sbatch1/infra/config/WriterConfig.class]
	- invalidCustomerWriter: defined by method 'invalidCustomerWriter' in class path resource [dev/prj/sbatch1/infra/config/WriterConfig.class]
	- customerClassifierWriter: defined by method 'customerClassifierWriter' in class path resource [dev/prj/sbatch1/infra/config/WriterConfig.class]

This may be due to missing parameter name information

Action:

Consider marking one of the beans as @Primary, updating the consumer to accept multiple beans, or using @Qualifier to identify the bean that should be consumed

Ensure that your compiler is configured to use the '-parameters' flag.
You may need to update both your build tool settings as well as your IDE.
(See https://github.com/spring-projects/spring-framework/wiki/Spring-Framework-6.1-Release-Notes#parameter-name-retention)


[2026-01-11 15:45:31.187] INFO  [main] dev.prj.sbatch1.Sbatch1 - Starting Sbatch1 using Java 24.0.1 with PID 16068 (C:\Workspace\JAVA\fprocessor\target\classes started by benil in C:\Workspace\JAVA\fprocessor)
[2026-01-11 15:45:31.190] DEBUG [main] dev.prj.sbatch1.Sbatch1 - Running with Spring Boot v4.0.1, Spring v7.0.2
[2026-01-11 15:45:31.191] INFO  [main] dev.prj.sbatch1.Sbatch1 - The following 1 profile is active: "dev"
[2026-01-11 15:45:32.947] INFO  [main] org.hibernate.orm.jpa - HHH008540: Processing PersistenceUnitInfo [name: default]
[2026-01-11 15:45:33.015] INFO  [main] org.hibernate.orm.core - HHH000001: Hibernate ORM core version 7.2.0.Final
[2026-01-11 15:45:34.337] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
[2026-01-11 15:45:34.796] INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:batchdb user=SA
[2026-01-11 15:45:34.800] INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
[2026-01-11 15:45:34.942] INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:batchdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: BATCHDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
[2026-01-11 15:45:36.618] INFO  [main] org.hibernate.orm.core - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
[2026-01-11 15:45:37.090] DEBUG [main] d.p.s.infra.batch.reader.FileReader - Reading file: src/main/resources/data/customers1.csv
[2026-01-11 15:45:37.655] INFO  [main] dev.prj.sbatch1.Sbatch1 - Started Sbatch1 in 7.088 seconds (process running for 8.269)
[2026-01-11 15:45:37.935] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Retry exhausted after last attempt in recovery path, but exception is not skippable
[2026-01-11 15:45:37.936] ERROR [main] o.s.b.c.step.item.ChunkOrientedStep - Rolling back chunk transaction
org.springframework.batch.infrastructure.item.WriterNotOpenException: Writer must be open before it can be written to
	at org.springframework.batch.infrastructure.item.support.AbstractFileItemWriter.write(AbstractFileItemWriter.java:227)
	at dev.prj.sbatch1.infra.config.WriterConfig.lambda$invalidCustomerWriter$0(WriterConfig.java:74)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy107.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
[2026-01-11 15:45:37.945] ERROR [main] o.s.batch.core.step.AbstractStep - Encountered an error executing step processAndValidateStep in job fileProcessorJob
org.springframework.batch.core.step.FatalStepExecutionException: Unable to process chunk
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:458)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processNextChunk(ChunkOrientedStep.java:389)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.lambda$doExecute$0(ChunkOrientedStep.java:373)
	at org.springframework.transaction.support.TransactionOperations.lambda$executeWithoutResult$0(TransactionOperations.java:68)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:137)
	at org.springframework.transaction.support.TransactionOperations.executeWithoutResult(TransactionOperations.java:67)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doExecute(ChunkOrientedStep.java:368)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:247)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:131)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:397)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:129)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:293)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:220)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:61)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.launchJobExecution(TaskExecutorJobLauncher.java:211)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:109)
	at org.springframework.batch.core.launch.support.SimpleJobOperator.start(SimpleJobOperator.java:201)
	at org.springframework.batch.core.launch.support.TaskExecutorJobOperator.start(TaskExecutorJobOperator.java:117)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:158)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:370)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:222)
	at jdk.proxy2/jdk.proxy2.$Proxy107.start(Unknown Source)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.execute(JobLauncherApplicationRunner.java:190)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.executeLocalJobs(JobLauncherApplicationRunner.java:174)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.launchJobFromProperties(JobLauncherApplicationRunner.java:154)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:149)
	at org.springframework.boot.batch.autoconfigure.JobLauncherApplicationRunner.run(JobLauncherApplicationRunner.java:143)
	at org.springframework.boot.SpringApplication.lambda$callRunner$0(SpringApplication.java:788)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:800)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:788)
	at org.springframework.boot.SpringApplication.lambda$callRunners$0(SpringApplication.java:776)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:186)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:571)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:560)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:153)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:176)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:265)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:636)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:776)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:328)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1365)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354)
	at dev.prj.sbatch1.Sbatch1.main(Sbatch1.java:10)
Caused by: org.springframework.batch.infrastructure.item.WriterNotOpenException: Writer must be open before it can be written to
	at org.springframework.batch.infrastructure.item.support.AbstractFileItemWriter.write(AbstractFileItemWriter.java:227)
	at dev.prj.sbatch1.infra.config.WriterConfig.lambda$invalidCustomerWriter$0(WriterConfig.java:74)
	at org.springframework.batch.infrastructure.item.support.ClassifierCompositeItemWriter.write(ClassifierCompositeItemWriter.java:69)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.doWrite(ChunkOrientedStep.java:733)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.writeChunk(ChunkOrientedStep.java:683)
	at org.springframework.batch.core.step.item.ChunkOrientedStep.processChunkSequentially(ChunkOrientedStep.java:449)
	... 52 common frames omitted
[2026-01-11 15:45:37.960] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
[2026-01-11 15:45:37.965] INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
